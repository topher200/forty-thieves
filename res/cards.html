<!DOCTYPE html>
<html>
  <head>
    <title>Cards</title>
    <link href="res/cards.css" rel="stylesheet">
  </head>
	<body>
		<button data-bind="click: newGame">New Game</button>
		<button data-bind="click: deal.bind($data, player1Cards, 1)">Deal Player 1</button>
		<button data-bind="click: deal.bind($data, player2Cards, 1)">Deal Player 2</button>
		<h4>Cards left <span data-bind="text: remainingInDeck"></span></h3>

		<h3>Player 1 Cards</h3>
		<h4>Points: <span data-bind="text: player1Points"></span></h4>
		<div data-bind="foreach: player1Cards">
			<div class="card" data-bind="css: $data.suit.toLowerCase()">
				<span data-bind="text: rank"></span> of 
				<span data-bind="text: suit"></span>
			</div>
		</div>
		<div class="clearfix"></div>
		
		<h3>Player 2 Cards</h3>
		<h4>Points: <span data-bind="text: player2Points"></span></h4>
		<div data-bind="foreach: player2Cards">
			<div class="card" data-bind="css: $data.suit.toLowerCase()">
				<span data-bind="text: rank"></span> of 
				<span data-bind="text: suit"></span>
			</div>
		</div>

    <!-- <div class="wrapper"> -->
    <!--   <div data-bind="foreach: foundations"> -->
    <!--     <\!-- Blank card spot -\-> -->
    <!--     <img class="card-spot pile" src="res/cards-png/b1fv.png"/> -->
    <!--     <\!-- Each card in the foundation -\-> -->
    <!--     <span data-bind="foreach: Cards"> -->
    <!--       <img class="card-spot card" data-bind="attr:{ src: 'res/cards-png/' + Suit + '-' + Face + '.png' }"/> -->
    <!--     </span> -->
    <!--   </div> -->
    <!-- </div> -->

    <p>Tables</p>

    <div class="wrapper">
      <div data-bind="foreach: tableaus">
        <div class="pile">
          <!-- Blank card spot -->
          <img class="card-spot blank-card" src="res/cards-png/b1fv.png"/>
          <!-- Each card in the tableau -->
          <span data-bind="foreach: Cards">
            <img class="card-spot card tableau"
                 data-bind="attr:{ src: $root.imageFilename($data), style: $root.tableauPosition($index()) }"
                 />
          </span>
        </div>
      </div>
    </div>

  </body>

	<script type="text/javascript" src="res/cards.js"></script>
  <script type="text/javascript" src="res/viewmodel.js"></script>

  <script type="text/javascript" src="bower_components/fallback/fallback.min.js"></script>
  <script>
    fallback.load({
      bootstrap_css: [
        "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css",
        "bower_components/bootstrap/dist/css/bootstrap.min.css"
      ],

      jQuery: [
        "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js",
        "bower_components/jquery/dist/jquery.min.js"
      ],

      ko: [
        "https://cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js",
        "bower_components/knockout/dist/knockout.js"
      ],

      'ko.mapping': [
        "https://cdnjs.cloudflare.com/ajax/libs/knockout.mapping/2.4.1/knockout.mapping.min.js",
        "bower_components/knockout.mapping/knockout.mapping.js"
      ],

      <!-- install bootstrap javascript -->
      'fn.modal': [
        "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js",
        "bower_components/bootstrap/dist/js/bootstrap.min.js"
      ]
    }, {
      shim: {
        'ko.mapping': ['ko'],
        <!-- Bootstrap's js requires jQuery -->
        'fn.modal': ['jQuery']
      }
    });

    fallback.ready(['ko', 'ko.mapping'], function() {
      var gameData = {
          cards: app.shuffle(app.makeDeck()),
          player1Cards: [],
          player2Cards: []
      };
      var model = new CardGameViewModel(gameData);
      ko.applyBindings(model);
    });
  </script>
	<script type="text/javascript" src="res/cards.js"></script>
</html>
